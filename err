from gpiozero import AngularServo
from gpiozero.pins.lgpio import LGPIOFactory # IMPORT THIS
from time import sleep

# 1. Force the Pi 5 to use the LGPIO system
# This removes the "PWMSoftwareFallback" warning
factory = LGPIOFactory()

# 2. Configure the servo using that factory
# Note: min_pulse_width/max_pulse_width might need tweaking for your specific motor (SM-S2309S)
# Standard is usually 0.001 to 0.002, but extended range is 0.0005 to 0.0025.
servo = AngularServo(18, 
                     min_angle=-90, 
                     max_angle=90, 
                     min_pulse_width=0.0005, 
                     max_pulse_width=0.0025,
                     pin_factory=factory) 

print("Testing Servo on GPIO 18 (Pin 12)...")

try:
    while True:
        print("Opening Gate (90)")
        servo.angle = 90
        sleep(2)
        
        print("Closing Gate (-90)")
        servo.angle = -90
        sleep(2)
except KeyboardInterrupt:
    print("Test Stopped")
